<!DOCTYPE html>
<html lang="en" prefix="og: https://ogp.me/ns#">
<head>
	<title>Gradle Project Layout</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<meta name="author" content="@nokeedev">
<meta name="keywords" content="blog">

<link rel="canonical" href="https://blog.nokee.dev/gradle-project-layout/">
<meta property="og:url" content="https://blog.nokee.dev/gradle-project-layout/">





<script type="application/ld+json">
    [{
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [{
  "@type": "ListItem",
  "position": 1,
  "name": "Blog",
  "item": "https://blog.nokee.dev/blog/"
},{
  "@type": "ListItem",
  "position": 2,
  "name": "Gradle Project Layout",
  "item": "https://blog.nokee.dev/gradle-project-layout/"
}]
    }]
</script>




<meta property="og:site_name" content="Nokee">
<meta property="og:title" content="Gradle Project Layout">




<meta name="twitter:site" content="@nokeedev">
<meta name="twitter:creator" content="@nokeedev">
<meta name="twitter:title" content="Gradle Project Layout">
<meta name="twitter:card" content="summary">




<!-- Le styles -->
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&family=Rajdhani" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Lato&display=swap" rel="stylesheet">
<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/normalize-8.0.1.css" rel="stylesheet">
<link href="/css/prettify.css" rel="stylesheet">
<link href="/css/menu.css" rel="stylesheet">

<link href="/css/colorscheme-light.css" rel="stylesheet">


<!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
<script src="/js/html5shiv.min.js"></script>
<![endif]-->

<!-- Fav and touch icons -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#001824">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="theme-color" content="#ffffff">


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-157599764-1"></script>
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());

	gtag('config', 'UA-157599764-1');
</script>

	<link href="../css/docs-asciidoctor.css" rel="stylesheet">
	<link href="../css/docs-asciidoctor-override.css" rel="stylesheet">
	<link href="../css/docs-asciidoctor-color-override.css" rel="stylesheet">
	<link href="../css/docs-base.css" rel="stylesheet">
	<link href="../css/multi-language-sample.css" rel="stylesheet">
	<link href="../css/blog-email-signup.css" rel="stylesheet">
	<link href="../css/blog-layout.css" rel="stylesheet">
	
</head>
<body onload="prettyPrint()">

	
<nav class="navigation" aria-labelledby="primary-navigation">
	<a href="/" class="logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 49.96"><defs></defs><g id="Layer_2" data-name="Layer 2"><g id="Layer_1-2" data-name="Layer 1"><g id="full-dark"><g id="nokee"><path d="M180.38,40.13a6.32,6.32,0,0,1-6.25-6.25V18.37a6.32,6.32,0,0,1,6.25-6.25H193.8A5.92,5.92,0,0,1,198.17,14a6,6,0,0,1,1.83,4.4V28.88H180.49s-.05,4.85,0,4.89,19.51.07,19.51.07v6.29Zm.11-16.84h13.15V18.48H180.49Z"/><path d="M51.3,40.13v-28H71A6,6,0,0,1,75.34,14a6,6,0,0,1,1.83,4.4V40.13H70.88l-.07-21.65H57.65l-.06,21.65Z"/><path d="M88.94,40.13a6.32,6.32,0,0,1-6.25-6.25V18.37a6.32,6.32,0,0,1,6.25-6.25h13.42A6,6,0,0,1,106.74,14a6.07,6.07,0,0,1,1.82,4.4V33.88a6.05,6.05,0,0,1-1.82,4.4,5.92,5.92,0,0,1-4.38,1.85Zm13.26-6.36s0-15.29,0-15.29H89.05s0,15.25,0,15.29S102.16,33.82,102.2,33.77Z"/><path d="M114.13,40.13V6.26h6.29V23.38h4l8.84-11.28h8.19L129.92,26.54l11.49,13.59h-8.19l-8.84-10.42h-4V40.13Z"/><path d="M149.25,40.13A6.32,6.32,0,0,1,143,33.88V18.37a6.32,6.32,0,0,1,6.25-6.25h13.42A6,6,0,0,1,167.05,14a6.07,6.07,0,0,1,1.82,4.4V28.88H149.36s-.05,4.85,0,4.89,19.51.07,19.51.07v6.29Zm.11-16.84h13.15V18.48H149.36Z"/></g><g id="bird"><path d="M41.82,10.21,25.58.83a6.24,6.24,0,0,0-6.23,0L3.11,10.21A6.24,6.24,0,0,0,0,15.6V34.35a6.25,6.25,0,0,0,3.11,5.4l16.24,9.37a6.24,6.24,0,0,0,6.23,0l16.24-9.37a6.25,6.25,0,0,0,3.11-5.4V15.6A6.24,6.24,0,0,0,41.82,10.21Zm-6,10.92c0,12.59-7.92,17.46-21.73,17.46A16.46,16.46,0,0,1,5,36c8.22-5.58,10.56-9.95,12.4-17.5,1.11-4.54,4.25-8.06,9.22-8.06,3.6,0,6.62,1.28,8.14,4.7h6.5l-5.49,4.39C35.82,20,35.84,20.57,35.84,21.13Z"/><path d="M28.94,13.72a3.35,3.35,0,0,0-3,1.76.83.83,0,0,0,1.46.79,1.7,1.7,0,0,1,3,0,.83.83,0,0,0,1.13.33.82.82,0,0,0,.33-1.12A3.36,3.36,0,0,0,28.94,13.72Z"/></g></g></g></g></svg></a>
	<input class="navigation-hamburger" type="checkbox" id="navigation-hamburger" />
	<label class="menu-icon" for="navigation-hamburger"><span class="navicon"></span></label>
	<ul class="navigation-items">
		<li><a href="/docs/current/manual/user-manual.html">Docs</a></li>
		<li><a href="/blog">Blog</a></li>
		<li><a href="/services/consulting.html">Services</a></li>
		<li>
			<ul class="navigation-socials">
				<li class="navigation-twitter"><a href="https://twitter.com/nokeedev" title="Nokee on Twitter"><svg width="24" height="24" viewBox="0 0 56.693 56.693" xmlns="http://www.w3.org/2000/svg"><path d="M28.348,5.157c-13.6,0-24.625,11.027-24.625,24.625c0,13.6,11.025,24.623,24.625,24.623c13.6,0,24.623-11.023,24.623-24.623  C52.971,16.184,41.947,5.157,28.348,5.157z M40.752,24.817c0.013,0.266,0.018,0.533,0.018,0.803c0,8.201-6.242,17.656-17.656,17.656  c-3.504,0-6.767-1.027-9.513-2.787c0.486,0.057,0.979,0.086,1.48,0.086c2.908,0,5.584-0.992,7.707-2.656  c-2.715-0.051-5.006-1.846-5.796-4.311c0.378,0.074,0.767,0.111,1.167,0.111c0.566,0,1.114-0.074,1.635-0.217  c-2.84-0.57-4.979-3.08-4.979-6.084c0-0.027,0-0.053,0.001-0.08c0.836,0.465,1.793,0.744,2.811,0.777  c-1.666-1.115-2.761-3.012-2.761-5.166c0-1.137,0.306-2.204,0.84-3.12c3.061,3.754,7.634,6.225,12.792,6.483  c-0.106-0.453-0.161-0.928-0.161-1.414c0-3.426,2.778-6.205,6.206-6.205c1.785,0,3.397,0.754,4.529,1.959  c1.414-0.277,2.742-0.795,3.941-1.506c-0.465,1.45-1.448,2.666-2.73,3.433c1.257-0.15,2.453-0.484,3.565-0.977  C43.018,22.849,41.965,23.942,40.752,24.817z"/></svg></a></li>
				<li class="navigation-github"><a href="https://github.com/nokeedev" title="Nokee on GitHub"><svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M10 0C4.477 0 0 4.477 0 10c0 4.418 2.865 8.166 6.839 9.489.5.092.682-.217.682-.482 0-.237-.008-.866-.013-1.7-2.782.603-3.369-1.342-3.369-1.342-.454-1.155-1.11-1.462-1.11-1.462-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.831.092-.646.35-1.086.636-1.336-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.268 2.75 1.026A9.578 9.578 0 0 1 10 4.836c.85.004 1.705.114 2.504.337 1.909-1.294 2.747-1.026 2.747-1.026.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.579.688.481C17.137 18.163 20 14.418 20 10c0-5.523-4.478-10-10-10" fill-rule="evenodd"></path></svg></a></li>
			</ul>
		</li>
	</ul>
</nav>

	<div class="main-content">

		<div class="chapter">
			<div class="header">
				
				<h1>Gradle Project Layout</h1>
				<p><em>30 June 2020</em></p>
			</div>

			<div class="content">
				<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Most build systems use the file system as the project layout.
It&#8217;s most notably the case for Make-based build system. <sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>
The file system-based project modelling approach is quick and easy to implement.
It relies on a simple check with the file system, and off the build goes.</p>
</div>
<div class="paragraph">
<p>However, it&#8217;s not a magic solution as it can be.
What happens when projects are deeply nested?
Or when we move projects around?
Or when we deal with legacy tools assuming a specific layout?
The solutions are often unimaginative and simply work around the core issue.
For example, native projects often prefer a flat layout.
Developers split the includes, binaries, and source codes into top-level folders.</p>
</div>
<div class="paragraph">
<p>Gradle has a distinct model for the project layout and on-disk layout.
By convention, both follow the same layout, e.g. project <code>:foo</code> is in folder <code>foo</code>.
However, we can configure Gradle to use two different layouts.
The Nokee project <a href="https://github.com/nokeedev/gradle-native/blob/ceccbc982c571fa6fde913dafb255f19ad64894a/settings.gradle#L52-L54">remap all projects inside the <em>subprojects</em> folders</a>.
The project folders follow a kebab convention, which differs from the project name, following a lowerCamelCase convention.</p>
</div>
<div class="paragraph">
<p>Gradle doesn&#8217;t stop there.
We can change the source layout convention, from the well-known Maven layout to something completely different.
We can relocate the build directory anywhere we want.
It renders the argument of in-source build vs out-source build irrelevant as Gradle can do both, or an hybrid or something completely crazy.
The point is, Gradle is much more flexible than everyone is using it.</p>
</div>
<div class="paragraph">
<p>With all this flexibility offered by Gradle, there isn&#8217;t an optimal project layout.
It depends on your projects.
Here are some guidelines to help you choose the right project layout.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="focus_on_what_you_are_building_instead_of_how"><a class="anchor" href="#focus_on_what_you_are_building_instead_of_how"></a><a class="link" href="#focus_on_what_you_are_building_instead_of_how">Focus on <strong>what</strong> you are building instead of <em>how</em></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Identifying the building blocks inside your repository will help create the project layout.
Whether your organization follows a mono-repo or multi-repo or whatever the on-disk source layout may be, there are always holistic building blocks to your projects.
Each of those blocks is a project.
Some of those blocks may only make sense together; make a note of them.</p>
</div>
<div class="paragraph">
<p>Some questions that can help you are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What kind of component is your build producing? Application? Library? Something else?</p>
</li>
<li>
<p>What are you distributing to your clients? RPM? Zip archives?</p>
</li>
<li>
<p>What is the relationship between your components? 3rd party libraries build from sources? Helper tools?</p>
</li>
<li>
<p>What are the artifacts produced? For other projects? For testing?</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="make_your_developers_happy"><a class="anchor" href="#make_your_developers_happy"></a><a class="link" href="#make_your_developers_happy">Make your developers happy</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Identifying which building blocks are essential to your developers will help establish an efficient project layout.
The developers are the users of the build.
The build system needs to work with them.
They also know which projects as well as which actions they require for their daily work.</p>
</div>
<div class="paragraph">
<p>For example, the holistic project layout may favour deep nesting of the projects.
However, the developer may only care about executing test coverage for a project subset.
It&#8217;s not about solving the deep nesting of projects but rather providing tasks to allow smooth test coverage execution.
Or maybe offer an umbrella project that exposes an aggregated set of actions for a subset of projects.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Did you know Gradle creates intermediate projects in your hierarchy?
For example, <code>include 'a:b:c'</code> creates a project <code>:a</code>, project <code>:a:b</code> and project <code>:a:b:c</code>.
Project <code>:a</code> could contain convenient tasks that act on its subprojects.
Then developer could execute <code>./gradlew :a:foo</code> which would apply to project :a:b and project <code>:a:b:c</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="not_all_projects_needs_a_build_script"><a class="anchor" href="#not_all_projects_needs_a_build_script"></a><a class="link" href="#not_all_projects_needs_a_build_script">Not all projects needs a build script</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some build systems identify projects by the presence of a build script.
Gradle configures projects as declared in the settings.gradle[.kts] file.
Whether the project build script exists or not, the project still exists and is configurable.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Did you know Gradle can inject configuration code inside any projects?
<code>project(path, Action)</code>, <code>subprojects(Action)</code> and <code>allprojects(Action)</code> are great ways to configure other projects than the currently configuring projects.
For example, you could use a single build.gradle to configure multiple projects:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>include 'a:b1'
include 'a:b2'
include 'a:b3'</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>project('b1') {
    //configure b1
}
project('b2') {
    //configure b2
}
project('b3') {
    // configure b3
}</pre>
</div>
</div>
<div class="paragraph">
<p>You could even model the <code>b*</code> projects inside project <code>:a</code> with an extension.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prefer_convention_over_configuration"><a class="anchor" href="#prefer_convention_over_configuration"></a><a class="link" href="#prefer_convention_over_configuration">Prefer convention-over-configuration</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The convention is always much more powerful than configuring each project individually.
Suppose a C library project is defined by the presence of C source files located by convention in <code>src/main/cpp</code>.
We could have something like this in the root build script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>allprojects {
    if (file('src/main/cpp').exists) {
        apply plugin: 'dev.nokee.cpp-library'
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>These four lines of code may apply to 100s of projects.
There was no need to create <code>build.gradle</code> files in those 100s of projects.</p>
</div>
<div class="paragraph">
<p>Now suppose some of those C++ library projects are in fact applications, we could build a look aside list of those <em>exceptions</em> and barely make the configuration anymore complicated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>def applicationProjects = [':foo', ':bar']
allprojects {
    if (file('src/main/cpp').exists) {
        if (applicationProjects.contains(path)) {
            apply plugin: 'dev.nokee.cpp-application'
        } else {
            apply plugin: 'dev.nokee.cpp-library'
        }
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>If by convention, application projects have an <code>App</code> suffix, we don&#8217;t need the lookaside list.
It may be tempting to nest applications and libraries under umbrella projects to allow easy configurations such as <code>project(':lib').subprojects { &#8230;&#8203; }</code>.
Experience has shown it&#8217;s usually better to avoid this kind of configuration.
There are some cases where it makes sense.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Did you know each build script is a Turin-complete language?
You can write modelling code as you see fit.
For example, suppose your project has 1000s of projects, but they all follow a similar on-disk convention layout.
You could write a file system walker to discover every project.
Since Gradle is JVM-based, you can use the <a href="https://docs.oracle.com/javase/8/docs/api/java/nio/file/Files.html#walkFileTree-java.nio.file.Path-java.nio.file.FileVisitor-(" class="bare">https://docs.oracle.com/javase/8/docs/api/java/nio/file/Files.html#walkFileTree-java.nio.file.Path-java.nio.file.FileVisitor-(</a><code>Files#walkFileTree</code> API) for this purpose.
There are some performance considerations, but we can mitigate them one way or another.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. Technically, Make don&#8217;t have a concept of projects, but most developers write their <em>project</em> modelling on top, which are mostly file-based.
</div>
</div>
			</div>
		</div>
	</div>

	<div id="push"></div>

	<!-- Begin Mailchimp Signup Form -->
	<p style="text-align:center">Stay on top of new features and news by subscribing:</p>
	<div id="mc_embed_signup">
		<form action="https://dev.us4.list-manage.com/subscribe/post?u=c1b91750dbe075432c8729552&amp;id=93402e2466" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
			<div id="mc_embed_signup_scroll">

			<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
			<!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
			<div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_c1b91750dbe075432c8729552_93402e2466" tabindex="-1" value=""></div>
			<div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
			</div>
			<small>* We will never send spam, and you can unsubscribe at any time</small>
		</form>
	</div>

	<!--End mc_embed_signup-->

	<!-- Start of comment -->
	<div id="disqus_thread"></div>
    <script>

    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
    */
    var disqus_config = function () {
    this.page.url = 'https://blog.nokee.dev/gradle-project-layout/index.html';
    this.page.identifier = 'gradle-project-layout';
    };
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://nokeedev.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		<div id="push"></div>

		<div id="footer">
			<div class="container">
				<p class="muted credit">&copy; 2020</p>
			</div>
		</div>

		<gdpr-banner></gdpr-banner>
<script src="/js/gdpr-banner.js" type="module"></script>

		<!-- Le javascript
		================================================== -->
		<!-- Placed at the end of the document so the pages load faster -->
		<script src="../js/prettify.js"></script>
		<script src="../js/multi-language-sample.js"></script>

	</body>

</html>
